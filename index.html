<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collapsible Content</title>
    <style>
        /* Basic styling for demonstration purposes */
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #121212; /* Dark background */
            color: #000; /* Black text color */
        }
        .content-container {
            max-width: 1200px;
            width: 100%;
            margin: 20px auto; /* Center align the container with margin */
            padding: 0 10px; /* Add padding for small devices */
        }
        .content-section {
            margin-bottom: 20px; /* Add more margin to separate sections */
        }
        .collapsible-container {
            width: 100%;
        }
        .collapsible, .content {
            border-radius: 5px;
        }
        .collapsible {
            cursor: pointer;
            border: none;
            outline: none;
            background-color: #1F1F1F; /* Darker background for buttons */
            color: #E0E0E0; /* Light text color */
            text-align: left;
            padding: 15px; /* Increased padding for better touch targets */
            width: 100%;
            font-size: 1rem; /* Standardize font size */
            transition: background-color 0.3s;
            margin-bottom: 10px; /* Add margin bottom */
        }
        .collapsible.active {
            background-color: #333; /* Slightly lighter background when active */
        }
        .content {
            display: none;
            padding: 15px; /* Add padding inside the content */
            overflow: hidden;
            background-color: #222; /* Dark background for content */
            margin-top: -10px; /* Adjust margin to align with button */
            color: #000; /* Black text color */
        }
        header, footer {
            background-color: #1F1F1F; /* Dark background */
            color: #E0E0E0; /* Light text color */
            padding: 15px; /* Increased padding for better appearance */
            text-align: center;
            width: 100%;
            box-sizing: border-box;
        }
        footer {
            margin-top: 20px; /* Add some space at the top */
        }
        .grouped-container {
            border: 1px solid #333; /* Light gray border */
            padding: 10px;
            margin-bottom: 20px; /* Add margin bottom */
            border-radius: 5px;
            background-color: #1A1A1A; /* Slightly lighter dark background */
        }
        .grouped-container h2 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #888888; /* Mid-gray text color */
        }
        @media only screen and (max-width: 600px) {
            .content-container {
                margin: 10px auto; /* Center the container */
                padding: 0 10px;
                box-sizing: border-box;
            }
            .collapsible {
                font-size: 0.9rem; /* Slightly smaller font size */
                padding: 10px;
            }
            .grouped-container {
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Lunar Base Project</h1>
    </header>

    <div class="content-container">
        <div id="content-container" class="collapsible-container">
            <!-- Content will be dynamically loaded here -->
        </div>
    </div>

    <footer>
        <p>&copy; 2024 Lucano Deskovic / lucano.deskovic@gmail.com / V 1.01 All rights reserved.</p>
    </footer>

    <script>
        const files = [
            'content/introduction.html', 
            'content/goals.html', 
            'content/population_size.html', 
            'content/use_cases_civilian-research.html', 
            'content/use_cases_civilian-resources.html', 
            'content/use_cases_civilian-health_tourism.html', 
            'content/use_cases_civilian-stepping_stone.html', 
            'content/use_cases_defence.html', 
            'content/architectural_concept.html', 
            'content/habitat_layout.html',
            'content/habitat_modules.html', 
            'content/habitat_materials.html',
            'content/inflatable_habitat.html', 			
            'content/water_storage_treatment.html', 
            'content/control_monitoring.html', 
            'content/surface_supply_logistics.html', 
            'content/mental_health_wellbeing.html', 
            'content/long_term_self_sufficiency.html', 
            'content/governance_management.html', 
            'content/safety_redundancy.html', 
            'content/environmental_control.html', 
            'content/list_of_disruptive_technologies.html', 
            'content/summary.html'
        ];

        // Function to fetch content and append to the DOM
        async function fetchAndDisplayContent() {
            const container = document.getElementById('content-container');

            // Array to store all fetch promises
            const fetchPromises = files.map(async file => {
                try {
                    const response = await fetch(file);
                    if (!response.ok) {
                        throw new Error(`Failed to fetch ${file}: ${response.status} ${response.statusText}`);
                    }
                    const html = await response.text();
                    return { file, html };
                } catch (error) {
                    console.error(error);
                    return { file, html: `<div>Error loading ${file}</div>` };
                }
            });

            // Wait for all promises to resolve
            const results = await Promise.all(fetchPromises);

            // Create containers for each group of sections
            const firstThreeContainer = createSectionContainer('Introduction');
            const nextFiveContainer = createSectionContainer('Application');
            const followingFiveContainer = createSectionContainer('Lunar Base Concept');
            const followingEightContainer = createSectionContainer('Logistics and Technology');
            const lastTwoContainer = createSectionContainer('Final Sections');

            // Track the number of sections added
            let sectionCount = 0;

            // Process each fetched result
            results.forEach(({ file, html }) => {
                // Create a temporary div to parse the HTML and find the title
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;

                // Find the header element (assuming it's the first h1 or h2)
                const headerElement = tempDiv.querySelector('h1, h2');

                // Use header text as button text
                const buttonText = headerElement ? headerElement.textContent : 'Untitled';

                // Create a section for each file's content
                const section = document.createElement('div');
                section.classList.add('content-section');
                section.innerHTML = `<button class="collapsible">${buttonText}</button><div class="content">${html}</div>`;

                // Append the section to the appropriate container
                if (sectionCount < 3) {
                    firstThreeContainer.appendChild(section);
                } else if (sectionCount < 8) {  // Next five chapters
                    nextFiveContainer.appendChild(section);
                } else if (sectionCount < 13) {  // Following five chapters
                    followingFiveContainer.appendChild(section);
                } else if (sectionCount < 21) {  // Following seven chapters
                    followingEightContainer.appendChild(section);
                } else {  // Last two chapters
                    lastTwoContainer.appendChild(section);
                }

                sectionCount++;
            });

            // Append the containers to the main container
            container.appendChild(firstThreeContainer);
            container.appendChild(nextFiveContainer);
            container.appendChild(followingFiveContainer);
            container.appendChild(followingEightContainer);
            container.appendChild(lastTwoContainer);

            // Trigger the collapsible functionality after all content is loaded
            triggerCollapsible();
        }

        // Function to create a container with a title
        function createSectionContainer(title) {
            const container = document.createElement('div');
            container.classList.add('content-section', 'grouped-container');

            const header = document.createElement('h2');
            header.textContent = title;
            container.appendChild(header);

            return container;
        }

        // Function to initialize collapsible elements
        function triggerCollapsible() {
            const coll = document.getElementsByClassName('collapsible');
                    
            Array.from(coll).forEach(function (item) {
                item.addEventListener('click', function () {
                    this.classList.toggle('active');
                    const content = this.nextElementSibling;
                    if (content.style.display === 'block') {
                        content.style.display = 'none';
                    } else {
                        content.style.display = 'block';
                    }
                });
            });
        }

        // Call the function to fetch and display content
        fetchAndDisplayContent();
    </script>
</body>
</html>
